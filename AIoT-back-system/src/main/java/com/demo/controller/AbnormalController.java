package com.demo.controller;


import com.alibaba.fastjson.JSONObject;
import com.demo.utils.JsonResult;
import com.gitee.freakchicken.DBAPI;
import lombok.extern.slf4j.Slf4j;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RestController;

import java.util.*;

/**
 * @author yuge
 */
@Slf4j
@RequestMapping("/abnormal")
@RestController
public class AbnormalController {

    @Autowired
    DBAPI dbapi;

    private JsonResult buildResult(List list) {
        JsonResult result = new JsonResult();
        result.buildTrueNew(list.size(), list);
        return result;
    }

    @RequestMapping("/abnormalInfo")
    public JsonResult abnormalInfo(@RequestParam("nodeType") String nodeType,
                                   @RequestParam(value = "process",required = false) String process) {
        Map<String, Object> map = new HashMap<>(1);
        map.put("process", process);
        map.put("nodeType", Objects.equals(nodeType, "all") ? null:nodeType);

        List<JSONObject> jsonObjects = dbapi.executeQuery("abnormal", "getAbnormalInfo",map);

        return buildResult(jsonObjects);
    }

    @RequestMapping("/safetyProblem")
    public JsonResult safetyProblem() {
        List<String> res=new ArrayList<>();
        res.add("14");res.add("113");res.add("97");
        res.add("15");res.add("95");res.add("3");
        return buildResult(res);
    }
    @RequestMapping("/securityWarningTrends")
    public JsonResult securityWarningTrends() {
        List<JSONObject> jsonObjects = dbapi.executeQuery("abnormal", "securityWarningTrends");

        return buildResult(jsonObjects);
    }

    @RequestMapping("/getPredictData")
    public JsonResult getPredictData(@RequestParam(value = "nodeId") String nodeId) {

        String data1="[[0,0,40],[0,1,84],[0,2,41],[0,3,31],[0,4,63],[0,5,74],[0,6,72],[0,7,55],[0,8,80],[1,0,67],[1,1,88],[1,2,93],[1,3,57],[1,4,3],[1,5,33],[1,6,14],[1,7,69],[1,8,112],[2,0,99],[2,1,60],[2,2,40],[2,3,64],[2,4,6],[2,5,74],[2,6,43],[2,7,32],[2,8,87],[3,0,64],[3,1,65],[3,2,19],[3,3,7],[3,4,96],[3,5,1],[3,6,35],[3,7,64],[3,8,59],[4,0,11],[4,1,55],[4,2,13],[4,3,39],[4,4,49],[4,5,92],[4,6,19],[4,7,22],[4,8,129],[5,0,25],[5,1,2],[5,2,48],[5,3,56],[5,4,33],[5,5,75],[5,6,1],[5,7,98],[5,8,130],[6,0,21],[6,1,81],[6,2,70],[6,3,7],[6,4,11],[6,5,74],[6,6,94],[6,7,17],[6,8,120],[7,0,38],[7,1,82],[7,2,16],[7,3,10],[7,4,36],[7,5,90],[7,6,95],[7,7,78],[7,8,138],[8,0,48],[8,1,29],[8,2,78],[8,3,18],[8,4,90],[8,5,23],[8,6,23],[8,7,65],[8,8,125],[9,0,53],[9,1,23],[9,2,98],[9,3,26],[9,4,76],[9,5,95],[9,6,5],[9,7,78],[9,8,87],[10,0,36],[10,1,89],[10,2,78],[10,3,83],[10,4,3],[10,5,53],[10,6,49],[10,7,51],[10,8,111],[11,0,45],[11,1,69],[11,2,41],[11,3,41],[11,4,57],[11,5,90],[11,6,54],[11,7,3],[11,8,105],[12,0,79],[12,1,16],[12,2,65],[12,3,29],[12,4,58],[12,5,46],[12,6,1],[12,7,57],[12,8,82],[13,0,84],[13,1,74],[13,2,90],[13,3,96],[13,4,61],[13,5,16],[13,6,21],[13,7,4],[13,8,125],[14,0,52],[14,1,51],[14,2,3],[14,3,0],[14,4,86],[14,5,8],[14,6,62],[14,7,5],[14,8,107],[15,0,13],[15,1,75],[15,2,53],[15,3,65],[15,4,59],[15,5,63],[15,6,51],[15,7,80],[15,8,66],[16,0,78],[16,1,74],[16,2,7],[16,3,57],[16,4,6],[16,5,18],[16,6,92],[16,7,70],[16,8,148],[17,0,10],[17,1,51],[17,2,70],[17,3,18],[17,4,63],[17,5,58],[17,6,38],[17,7,76],[17,8,95],[18,0,65],[18,1,42],[18,2,93],[18,3,44],[18,4,28],[18,5,22],[18,6,96],[18,7,18],[18,8,51],[19,0,3],[19,1,34],[19,2,14],[19,3,21],[19,4,16],[19,5,32],[19,6,16],[19,7,66],[19,8,148],[20,0,71],[20,1,51],[20,2,19],[20,3,52],[20,4,67],[20,5,55],[20,6,65],[20,7,37],[20,8,145],[21,0,13],[21,1,14],[21,2,71],[21,3,62],[21,4,39],[21,5,36],[21,6,77],[21,7,57],[21,8,129],[22,0,12],[22,1,45],[22,2,75],[22,3,1],[22,4,10],[22,5,20],[22,6,1],[22,7,87],[22,8,116],[23,0,47],[23,1,25],[23,2,26],[23,3,23],[23,4,2],[23,5,53],[23,6,18],[23,7,55],[23,8,146],[24,0,80],[24,1,58],[24,2,51],[24,3,2],[24,4,37],[24,5,9],[24,6,41],[24,7,50],[24,8,72],[25,0,25],[25,1,28],[25,2,57],[25,3,66],[25,4,84],[25,5,88],[25,6,32],[25,7,42],[25,8,145],[26,0,42],[26,1,26],[26,2,57],[26,3,78],[26,4,43],[26,5,76],[26,6,4],[26,7,90],[26,8,83],[27,0,62],[27,1,86],[27,2,80],[27,3,83],[27,4,34],[27,5,62],[27,6,97],[27,7,65],[27,8,119],[28,0,65],[28,1,64],[28,2,19],[28,3,52],[28,4,59],[28,5,62],[28,6,18],[28,7,90],[28,8,128],[29,0,43],[29,1,60],[29,2,47],[29,3,48],[29,4,86],[29,5,57],[29,6,98],[29,7,56],[29,8,128],[30,0,56],[30,1,43],[30,2,98],[30,3,63],[30,4,71],[30,5,13],[30,6,92],[30,7,56],[30,8,55],[31,0,62],[31,1,90],[31,2,38],[31,3,96],[31,4,7],[31,5,94],[31,6,71],[31,7,8],[31,8,91],[32,0,73],[32,1,20],[32,2,27],[32,3,9],[32,4,34],[32,5,92],[32,6,86],[32,7,81],[32,8,54],[33,0,84],[33,1,29],[33,2,47],[33,3,83],[33,4,40],[33,5,29],[33,6,8],[33,7,44],[33,8,118],[34,0,79],[34,1,91],[34,2,8],[34,3,5],[34,4,99],[34,5,61],[34,6,60],[34,7,8],[34,8,85],[35,0,53],[35,1,24],[35,2,5],[35,3,66],[35,4,35],[35,5,80],[35,6,15],[35,7,8],[35,8,131],[36,0,72],[36,1,57],[36,2,81],[36,3,38],[36,4,81],[36,5,56],[36,6,0],[36,7,60],[36,8,57],[37,0,80],[37,1,16],[37,2,45],[37,3,31],[37,4,53],[37,5,27],[37,6,93],[37,7,69],[37,8,64],[38,0,95],[38,1,3],[38,2,85],[38,3,60],[38,4,13],[38,5,29],[38,6,38],[38,7,43],[38,8,74],[39,0,25],[39,1,13],[39,2,24],[39,3,8],[39,4,95],[39,5,56],[39,6,85],[39,7,25],[39,8,52],[40,0,42],[40,1,30],[40,2,8],[40,3,89],[40,4,78],[40,5,11],[40,6,1],[40,7,28],[40,8,54],[41,0,92],[41,1,56],[41,2,39],[41,3,22],[41,4,18],[41,5,49],[41,6,18],[41,7,72],[41,8,59],[42,0,32],[42,1,96],[42,2,41],[42,3,83],[42,4,85],[42,5,55],[42,6,85],[42,7,3],[42,8,101],[43,0,68],[43,1,82],[43,2,86],[43,3,7],[43,4,18],[43,5,31],[43,6,24],[43,7,33],[43,8,91],[44,0,4],[44,1,59],[44,2,64],[44,3,47],[44,4,12],[44,5,51],[44,6,26],[44,7,40],[44,8,119]]";
        String data2="[[0,0,77],[0,1,2],[0,2,98],[0,3,45],[0,4,63],[0,5,31],[0,6,18],[0,7,21],[0,8,143],[1,0,92],[1,1,31],[1,2,28],[1,3,63],[1,4,65],[1,5,91],[1,6,44],[1,7,71],[1,8,75],[2,0,14],[2,1,55],[2,2,14],[2,3,8],[2,4,99],[2,5,39],[2,6,38],[2,7,17],[2,8,75],[3,0,88],[3,1,69],[3,2,37],[3,3,61],[3,4,25],[3,5,47],[3,6,41],[3,7,49],[3,8,117],[4,0,28],[4,1,77],[4,2,78],[4,3,17],[4,4,67],[4,5,46],[4,6,37],[4,7,55],[4,8,109],[5,0,63],[5,1,71],[5,2,51],[5,3,6],[5,4,81],[5,5,41],[5,6,55],[5,7,61],[5,8,101],[6,0,86],[6,1,28],[6,2,17],[6,3,85],[6,4,51],[6,5,73],[6,6,66],[6,7,34],[6,8,145],[7,0,17],[7,1,0],[7,2,84],[7,3,85],[7,4,18],[7,5,88],[7,6,77],[7,7,32],[7,8,114],[8,0,56],[8,1,73],[8,2,60],[8,3,59],[8,4,9],[8,5,64],[8,6,23],[8,7,77],[8,8,74],[9,0,61],[9,1,24],[9,2,86],[9,3,33],[9,4,92],[9,5,81],[9,6,75],[9,7,92],[9,8,119],[10,0,75],[10,1,31],[10,2,23],[10,3,40],[10,4,58],[10,5,21],[10,6,5],[10,7,80],[10,8,146],[11,0,65],[11,1,77],[11,2,53],[11,3,4],[11,4,16],[11,5,15],[11,6,23],[11,7,26],[11,8,90],[12,0,32],[12,1,11],[12,2,35],[12,3,96],[12,4,42],[12,5,63],[12,6,17],[12,7,73],[12,8,70],[13,0,75],[13,1,41],[13,2,39],[13,3,50],[13,4,60],[13,5,55],[13,6,43],[13,7,32],[13,8,133],[14,0,12],[14,1,49],[14,2,79],[14,3,20],[14,4,69],[14,5,61],[14,6,50],[14,7,84],[14,8,132],[15,0,3],[15,1,40],[15,2,14],[15,3,2],[15,4,18],[15,5,86],[15,6,88],[15,7,93],[15,8,59],[16,0,2],[16,1,33],[16,2,91],[16,3,4],[16,4,5],[16,5,77],[16,6,51],[16,7,50],[16,8,106],[17,0,45],[17,1,22],[17,2,45],[17,3,40],[17,4,69],[17,5,33],[17,6,20],[17,7,33],[17,8,133],[18,0,39],[18,1,97],[18,2,35],[18,3,6],[18,4,9],[18,5,68],[18,6,74],[18,7,83],[18,8,136],[19,0,18],[19,1,61],[19,2,44],[19,3,43],[19,4,22],[19,5,99],[19,6,52],[19,7,86],[19,8,66],[20,0,50],[20,1,17],[20,2,92],[20,3,35],[20,4,23],[20,5,27],[20,6,24],[20,7,45],[20,8,79],[21,0,33],[21,1,78],[21,2,39],[21,3,45],[21,4,4],[21,5,37],[21,6,36],[21,7,41],[21,8,98],[22,0,89],[22,1,32],[22,2,14],[22,3,7],[22,4,35],[22,5,87],[22,6,52],[22,7,73],[22,8,67],[23,0,60],[23,1,69],[23,2,48],[23,3,50],[23,4,10],[23,5,23],[23,6,76],[23,7,31],[23,8,69],[24,0,16],[24,1,97],[24,2,21],[24,3,89],[24,4,70],[24,5,16],[24,6,51],[24,7,79],[24,8,70],[25,0,54],[25,1,60],[25,2,84],[25,3,68],[25,4,11],[25,5,50],[25,6,78],[25,7,6],[25,8,145],[26,0,31],[26,1,42],[26,2,47],[26,3,0],[26,4,36],[26,5,5],[26,6,50],[26,7,71],[26,8,71],[27,0,32],[27,1,68],[27,2,53],[27,3,56],[27,4,58],[27,5,95],[27,6,77],[27,7,3],[27,8,71],[28,0,99],[28,1,5],[28,2,81],[28,3,26],[28,4,41],[28,5,43],[28,6,97],[28,7,20],[28,8,53],[29,0,13],[29,1,30],[29,2,76],[29,3,77],[29,4,56],[29,5,22],[29,6,73],[29,7,67],[29,8,108],[30,0,58],[30,1,51],[30,2,81],[30,3,5],[30,4,75],[30,5,94],[30,6,84],[30,7,62],[30,8,147],[31,0,71],[31,1,0],[31,2,87],[31,3,40],[31,4,79],[31,5,51],[31,6,6],[31,7,8],[31,8,99],[32,0,87],[32,1,72],[32,2,10],[32,3,28],[32,4,83],[32,5,70],[32,6,12],[32,7,8],[32,8,132],[33,0,61],[33,1,1],[33,2,24],[33,3,86],[33,4,74],[33,5,99],[33,6,46],[33,7,42],[33,8,68],[34,0,1],[34,1,29],[34,2,31],[34,3,96],[34,4,98],[34,5,86],[34,6,47],[34,7,59],[34,8,110],[35,0,58],[35,1,50],[35,2,1],[35,3,19],[35,4,16],[35,5,15],[35,6,36],[35,7,19],[35,8,140],[36,0,66],[36,1,80],[36,2,91],[36,3,30],[36,4,6],[36,5,6],[36,6,97],[36,7,52],[36,8,110],[37,0,26],[37,1,28],[37,2,54],[37,3,12],[37,4,68],[37,5,1],[37,6,94],[37,7,35],[37,8,92],[38,0,39],[38,1,20],[38,2,8],[38,3,3],[38,4,9],[38,5,67],[38,6,40],[38,7,25],[38,8,106],[39,0,62],[39,1,9],[39,2,23],[39,3,7],[39,4,60],[39,5,39],[39,6,7],[39,7,40],[39,8,82],[40,0,31],[40,1,52],[40,2,17],[40,3,46],[40,4,68],[40,5,91],[40,6,15],[40,7,40],[40,8,79],[41,0,28],[41,1,51],[41,2,96],[41,3,2],[41,4,73],[41,5,17],[41,6,80],[41,7,17],[41,8,80],[42,0,7],[42,1,31],[42,2,46],[42,3,40],[42,4,1],[42,5,73],[42,6,78],[42,7,45],[42,8,121],[43,0,42],[43,1,36],[43,2,13],[43,3,74],[43,4,55],[43,5,74],[43,6,91],[43,7,4],[43,8,85],[44,0,33],[44,1,75],[44,2,0],[44,3,31],[44,4,23],[44,5,8],[44,6,19],[44,7,23],[44,8,76]]";
        String res;
        if (Objects.equals(nodeId, "1")){
            res=data1;
        }else {
            res=data2;
        }

        JsonResult result = new JsonResult();
        result.buildTrueNew(res);
        return result;
    }
}

